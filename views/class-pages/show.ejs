<% layout('./layouts/boilerplate.ejs') %> <%-
include('../partials/show-header.ejs', {typeName: 'class', type: singleClass,
name: `${singleClass.className}`}) %>

<p>
  <strong>Teacher:</strong> <%= singleClass.teacher %>
  <br />
  <strong>Class Code: </strong> <%= singleClass.classCode %>
  <br />
  <strong>Section: </strong> <%= singleClass.section %>
  <br />
  <strong>Subject: </strong> <%= singleClass.subject %>
  <br />
</p>
<div class="d-flex flex-wrap justify-content-between align-items-center">
  <p class="h4 mb-3">Students:</p>
  <div
    class="d-flex justify-content-end justify-content-md-between btn-toolbar mb-2"
  >
    <a
      class="btn btn-outline-primary mx-2 mb-2 mb-sm-0 align-middle"
      href="/class/<%= singleClass._id %>/addStudent"
      >Add Students</a
    >
    <% if (singleClass.studentsInClass.length > 0) { %>
    <a
      class="btn btn-outline-danger me-sm-2 mb-2 mb-sm-0"
      href="/class/<%= singleClass._id %>/removeStudent"
      >Remove Students</a
    >
    <% } %>
  </div>
</div>
<% let num = 1 %>
    <table class="table table-hover">
      <thead class="thead-light">
        <tr>
          <th scope="col" class="px-0"></th>
          <th scope="col">Student ID</th>
          <th scope="col">First</th>
          <th scope="col">Last</th>
          <th class="text-center" scope="col">Attendance</th>
          <th class="text-center" scope="col">View</th>                                
        </tr>
      </thead>
      <% if (singleClass.studentsInClass.length) { %>
      <tbody>
        <% 
        for (let { student, numAttendancesPresent } of singleClass.studentsInClass) { %>
        <tr>
          <th scope="row" class="text-center ps-0"><%= num %>.</th>
          <td><%= student.studentId %></th>
          <td><%= student.firstName %></td>
          <td><%= student.lastName %></td>
          <td class="text-center"><%= singleClass.numAttendancesTaken > 0 ? Number(Math.round( 100*(numAttendancesPresent / singleClass.numAttendancesTaken) + 'e2') + 'e-2') : 0 %>%</td>
          <td class="text-center">
            <a class="btn btn-outline-secondary px-3 py-1" href="/student/<%= student._id %>"
              ><i class="fa fa-user"></i></a
            >
          </td>                 
        </tr>
        <% num++ 
      } %>
      </tbody>
      <% } %>
    </table>
